<div class="col-md-12">
  <div class="box">
    <div class="box-header">
      <h3 class="box-title">用户：<%= "#{@user.name}(email:#{@user.email})" %></h3>
    </div>
    <div class="box-body table-responsive no-padding">
      <table class="table table-hover">
        <tr>
          <th>商品</th>
          <th>特价</th>
          <th>操作</th>
        </tr>
        <% @special_prices.each do |price| %>
          <tr>
            <td><%= "#{price.goods.name}(ID#{price.goods.id})" %></td>
            <td><%= price.price %></td>
            <td>
              <%= link_to '修改', edit_special_price_path(price.id) %>
              <%= link_to '删除', special_price_path(price.id), method: 'delete', data: { confirm: '确认删除' } %>
            </td>
          </tr>
        <% end %>
      </table>
    </div>
  </div>
  <button type="button" class="btn btn-default" data-toggle="modal" data-target="#modal-default">
    添加新特价
  </button>
</div>

<div class="modal fade" id="modal-default">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">为 <%= @user.email%> 添加新特价</h4>
      </div>
      <%= form_for SpecialPrice.new, html: {:class => 'form-horizontal'} do |f| %>
        <div class="modal-body">
            <div class="box-body">
              <div class="form-group">
                <%= f.label :goods_id, '业务', class: 'col-sm-2 control-label '%>

                <div class="col-sm-10">
                  <%= f.select :goods_id, Goods.all.collect { |g| [ g.name, g.id ] }, {}, class: 'form-control goods-id' %>
                </div>
              </div>
              <%= f.hidden_field :user_id, value: @user.id, class: 'form-control goods-id' %>
              <div class="form-group">
                <%= f.label :price, '特价', class: 'col-sm-2 control-label'%>

                <div class="col-sm-10">
                  <%= f.text_field :price, class: 'form-control', placeholder: '单价' %>
                </div>
              </div>
              <div class="form-group">
                <%= f.label :remark, '备注', class: 'col-sm-2 control-label'%>

                <div class="col-sm-10">
                  <%= f.text_area :remark, class: 'form-control', rows: 5, placeholder: '特价备注' %>
                </div>
              </div>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">放弃</button>
          <%= submit_tag '提交', class: 'btn btn-primary' %>
        </div>
      <% end %>
    </div>
  </div>
</div>
