<%= render 'search_form' %>

<div class="col-md-12">
    <div class="box">
      <div class="box-header with-border">
        <h3 class="box-title">我的订单</h3>
      </div>
      <div class="box-body">
        <table class="table table-bordered">
          <tr>
            <th style="width: 75px">订单编号</th>
            <th>下单时间</th>
            <th>业务</th>
            <th>数量</th>
            <th>购买时单价</th>
            <th>总金额</th>
            <td>下单账号</td>
            <th>备注</th>
            <th>初始数量</th>
            <th>目标数量</th>
            <th>当前数量</th>
            <th>状态</th>
          </tr>
          <% @orders.each do |order| %>
            <tr>
              <td><%= order.identification_code %></td>
              <td><%= order.created_at.strftime('%Y-%m-%d %H:%M:%S') %></td>
              <td><%= order.goods.name rescue ''%></td>
              <td><%= order.count %></td>
              <td><%= order.price_current %></td>
              <td><%= order.total_price %></td>
              <td><%= order.account %></td>
              <td><%= order.remark %></td>
              <td><%= order.start_num %></td>
              <td><%= order.aims_num %></td>
              <td><%= order.current_num %></td>
              <td><%= order.status_in_word %></td>
            </tr>
          <% end %>
        </table>
      </div>
      <div class="box-footer clearfix">
        <ul class="pagination pagination-sm inline">
          <%= paginate @orders %>
        </ul>
      </div>
    </div>
</div>

<script>
$().ready(function() {
  //订单验证
  $("#new_order").validate({
    errorPlacement: function(error, element){
      $(element).parent('div').addClass('has-error');
      $(element).parent('div').append(error);
    },
		errorElement: 'label',
    errorClass: 'error',
    rules: {
      'order[goods_id]': "required",
      'order[price_current]': {
        required: true,
        number:true
      },
      'order[count]': {
        required: true,
        digits: true,
        min: 1
      },
      'order[account]': "required"
    },
    messages: {
      'order[goods_id]': "请选择业务",
      'order[price_current]': {
        required: '单价必须填写',
        number: '单价必须是数字'
      },
      'order[count]':{
        required: '数量不能为空',
        digits: '必须输入整数',
        min: '下单数量不能小于1'
      },
      'order[account]': "目标账户必须填写"
    }
  });
});
</script>
